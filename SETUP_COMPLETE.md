# üéâ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Approval Cloud –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ **Node.js v22.18.0** –∏ **npm 10.9.3** –Ω–∞–π–¥–µ–Ω—ã
- ‚úÖ **–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (562 –ø–∞–∫–µ—Ç–∞)

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ **–§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** `.env` —Å–æ–∑–¥–∞–Ω
- ‚úÖ **–ü–∞–ø–∫–∏ –¥–ª—è –ª–æ–≥–æ–≤** —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞** –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

### 3. –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∑–∞–ø—É—Å–∫–∞
- ‚úÖ **start.sh** - —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- ‚úÖ **dev.sh** - —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- ‚úÖ **–£–¥–∞–ª–µ–Ω –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–∞–∫–µ—Ç** `passport-bitrix24`
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è** –¥–ª—è Bitrix24 OAuth
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**

## üèóÔ∏è –°–æ–∑–¥–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`src/webapp/`)
```
src/webapp/
‚îú‚îÄ‚îÄ server.js              # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ package.json           # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ logs/                  # –ü–∞–ø–∫–∞ –¥–ª—è –ª–æ–≥–æ–≤
‚îú‚îÄ‚îÄ routes/                # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ auth.js            # OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ bitrix24.js        # Bitrix24 REST API
‚îÇ   ‚îú‚îÄ‚îÄ approvals.js       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ telegram.js        # Telegram Bot –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ webhooks.js        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±-—Ö—É–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ admin.js           # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îî‚îÄ‚îÄ strategies/            # Passport —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    ‚îî‚îÄ‚îÄ bitrix24.js        # –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è Bitrix24
```

### API Endpoints
- ‚úÖ **Health Check:** `GET /health`
- ‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** `GET /api/auth/status`
- ‚úÖ **Bitrix24:** `GET /api/bitrix24/users`
- ‚úÖ **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è:** `GET /api/approvals`
- ‚úÖ **Telegram:** `POST /api/telegram/webhook`
- ‚úÖ **–í–µ–±-—Ö—É–∫–∏:** `POST /api/webhooks/universal`
- ‚úÖ **–ê–¥–º–∏–Ω:** `GET /api/admin/stats`

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
- **URL:** http://localhost:3000
- **Health Check:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
- **API Endpoints:** ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **Health Check:** `{"status":"ok","timestamp":"2025-08-21T13:27:01.491Z","version":"1.0.0","environment":"development"}`
- **Auth Status:** `{"authenticated":false}` (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- **Admin Stats:** `{"error":"–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω"}` (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∑–∞—â–∏—Ç–∞)

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Bitrix24
1. **–í–æ–π–¥–∏—Ç–µ –≤ Bitrix24** –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º"** ‚Üí **"–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è"**
3. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   - –ù–∞–∑–≤–∞–Ω–∏–µ: `Telegram Approval Cloud`
   - URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: `http://localhost:3000`
   - URL –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: `http://localhost:3000/api/auth/bitrix24`
   - –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: CRM, –ó–∞–¥–∞—á–∏, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot
1. **–ù–∞–ø–∏—à–∏—Ç–µ @BotFather** –≤ Telegram
2. **–°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞:** `/newbot`
3. **–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω** –±–æ—Ç–∞
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook:**
   ```bash
   curl -X POST "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/setWebhook" \
        -H "Content-Type: application/json" \
        -d '{"url": "http://localhost:3000/api/telegram/webhook"}'
   ```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `src/webapp/.env`:
```env
# Bitrix24
BITRIX24_CLIENT_ID=your_client_id
BITRIX24_CLIENT_SECRET=your_client_secret
BITRIX24_CALLBACK_URL=http://localhost:3000/api/auth/bitrix24/callback

# Telegram
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_BOT_USERNAME=your_bot_username

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
NODE_ENV=development
PORT=3000
SESSION_SECRET=your_session_secret_change_this
BACKEND_URL=http://localhost:3000
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** http://localhost:3000
2. **–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å** —á–µ—Ä–µ–∑ Bitrix24
3. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ**
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** –ø–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram
5. **–û—Ç–≤–µ—Ç—å—Ç–µ** –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ
6. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ Bitrix24

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **README.md** - –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
- **CLOUD_BITRIX24_ARCHITECTURE.md** - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **MIGRATION_COMPLETE.md** - –æ—Ç—á–µ—Ç –æ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞:
- **docs/cloud-setup/bitrix24-setup.md** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Bitrix24
- **docs/cloud-setup/telegram-setup.md** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram
- **docs/cloud-setup/deployment.md** - –¥–µ–ø–ª–æ–π

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### –ó–∞–ø—É—Å–∫
```bash
# –ü—Ä–æ–¥–∞–∫—à–Ω
./start.sh

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
./dev.sh
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å
ps aux | grep node

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
kill <PID>
```

### –õ–æ–≥–∏
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
tail -f src/webapp/logs/app.log
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

**Telegram Approval Cloud —É—Å–ø–µ—à–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!**

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä** –Ω–∞ –ø–æ—Ä—Ç—É 3000
- **OAuth 2.0 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** —á–µ—Ä–µ–∑ Bitrix24
- **REST API** –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **Telegram Bot** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **–°–∏—Å—Ç–µ–º–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–π**
- **–í–µ–±-—Ö—É–∫–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**

### üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
- ‚úÖ **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞**
- ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π**
- ‚úÖ **–î–µ–ø–ª–æ–π –Ω–∞ –æ–±–ª–∞—á–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã**

---

**üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í–∞—à–µ –æ–±–ª–∞—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ Telegram –≤ Bitrix24 –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ!** üöÄ
