<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Approval Cloud</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .status {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .api-section {
            margin: 30px 0;
        }
        .api-section h3 {
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
            padding-bottom: 10px;
        }
        .endpoint {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
        }
        .method {
            color: #4CAF50;
            font-weight: bold;
        }
        .url {
            color: #2196F3;
        }
        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: transform 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .btn-secondary {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }
        .btn-warning {
            background: linear-gradient(45deg, #FF9800, #F57C00);
        }
        .response {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        .success {
            color: #4CAF50;
            font-weight: bold;
        }
        .error {
            color: #f44336;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Telegram Approval Cloud</h1>
        
        <div class="status">
            <h2>üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h2>
            <p><strong>–°–µ—Ä–≤–µ—Ä:</strong> <span id="server-status">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span></p>
            <p><strong>–í—Ä–µ–º—è:</strong> <span id="current-time"></span></p>
            <p><strong>–í–µ—Ä—Å–∏—è:</strong> <span id="version">1.0.0</span></p>
            <p><strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</strong> <span id="platform">–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ...</span></p>
        </div>

        <div class="api-section">
            <h3>üîó API Endpoints</h3>
            
            <div class="endpoint">
                <span class="method">GET</span> <span class="url">/health</span> - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞
                <button class="btn" onclick="testEndpoint('/health')">–¢–µ—Å—Ç</button>
            </div>
            
            <div class="endpoint">
                <span class="method">GET</span> <span class="url">/api/auth/status</span> - –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                <button class="btn" onclick="testEndpoint('/api/auth/status')">–¢–µ—Å—Ç</button>
            </div>
            
            <div class="endpoint">
                <span class="method">POST</span> <span class="url">/api/webhooks/test</span> - –¢–µ—Å—Ç–æ–≤—ã–π webhook
                <button class="btn btn-secondary" onclick="testWebhook()">–¢–µ—Å—Ç</button>
            </div>
            
            <div class="endpoint">
                <span class="method">GET</span> <span class="url">/api/admin/stats</span> - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
                <button class="btn btn-warning" onclick="testEndpoint('/api/admin/stats')">–¢–µ—Å—Ç</button>
            </div>
        </div>

        <div class="api-section">
            <h3>üìù –û—Ç–≤–µ—Ç—ã API</h3>
            <div id="api-response" class="response">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–¢–µ—Å—Ç" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ endpoint</div>
        </div>

        <div class="api-section">
            <h3>üîß –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏</h3>
            <ol>
                <li>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Bitrix24</li>
                <li>–°–æ–∑–¥–∞–π—Ç–µ Telegram Bot —á–µ—Ä–µ–∑ @BotFather</li>
                <li>–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ —Ñ–∞–π–ª–µ .env</li>
                <li>–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é</li>
            </ol>
        </div>
    </div>

    <script>
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function updateTime() {
            document.getElementById('current-time').textContent = new Date().toLocaleString('ru-RU');
        }
        updateTime();
        setInterval(updateTime, 1000);

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
        async function checkServerStatus() {
            try {
                const response = await fetch('/health');
                const data = await response.json();
                document.getElementById('server-status').textContent = '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç';
                document.getElementById('version').textContent = data.version;
                document.getElementById('platform').textContent = data.platform || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            } catch (error) {
                document.getElementById('server-status').textContent = '‚ùå –û—à–∏–±–∫–∞';
                document.getElementById('platform').textContent = '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è';
            }
        }
        checkServerStatus();

        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ endpoint
        async function testEndpoint(endpoint) {
            const responseDiv = document.getElementById('api-response');
            responseDiv.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
            
            try {
                const response = await fetch(endpoint);
                const data = await response.json();
                responseDiv.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                responseDiv.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
            }
        }

        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook
        async function testWebhook() {
            const responseDiv = document.getElementById('api-response');
            responseDiv.textContent = '–û—Ç–ø—Ä–∞–≤–∫–∞ webhook...';
            
            try {
                const response = await fetch('/api/webhooks/test', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        test: 'data',
                        timestamp: new Date().toISOString()
                    })
                });
                const data = await response.json();
                responseDiv.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                responseDiv.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
            }
        }
    </script>
</body>
</html>
